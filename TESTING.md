# Руководство по тестированию mod-hardcore

## Подготовка к тестированию

### 1. Сборка модуля

**Windows:**
```powershell
cd G:\azerothcore-wotlk\build
cmake ../ -DCMAKE_INSTALL_PREFIX="G:\azerothcore-server"
cmake --build . --config RelWithDebInfo -j 8
```

**Linux:**
```bash
cd /path/to/azerothcore-wotlk/build
cmake ../ -DCMAKE_INSTALL_PREFIX=/path/to/server
make -j$(nproc)
make install
```

### 2. Импорт SQL

```sql
-- Подключитесь к базе данных
mysql -u root -p acore_world

-- Импортируйте SQL
source G:/azerothcore-wotlk/modules/mod-hardcore/data/sql/db-world/base/hardcore_gameobject.sql;

-- Проверьте импорт
SELECT COUNT(*) FROM gameobject WHERE id = 300001;
-- Должно быть 8 объектов

exit
```

### 3. Конфигурация

Скопируйте и отредактируйте конфигурационный файл:

**Windows:**
```powershell
copy G:\azerothcore-wotlk\modules\mod-hardcore\conf\hardcore.conf.dist ^
     G:\azerothcore-server\etc\modules\hardcore.conf
```

**Linux:**
```bash
cp /path/to/modules/mod-hardcore/conf/hardcore.conf.dist \
   /path/to/server/etc/modules/hardcore.conf
```

---

## Тестовые сценарии

### Тест 1: Базовая активация

**Цель:** Проверить активацию режима хардкор

**Шаги:**
1. Создайте нового персонажа 1 уровня
2. Найдите объект "Активация Хардкор" на кладбище
3. Взаимодействуйте с объектом
4. Используйте команду `.hardcore status`

**Ожидаемый результат:**
- ✅ Появилась красная аура
- ✅ Глобальное сообщение в чат
- ✅ Сообщение на экран всем игрокам
- ✅ Команда показывает "Режим: АКТИВЕН"

---

### Тест 2: Проверка команд

**Цель:** Проверить работу игровых команд

**Шаги:**
1. Войдите персонажем с активным хардкором
2. Выполните `.hardcore status`
3. Выполните `.hardcore info`

**Ожидаемый результат:**
- ✅ `.hardcore status` показывает детальную информацию
- ✅ `.hardcore info` показывает правила и модификаторы
- ✅ Корректное форматирование вывода

---

### Тест 3: Окончательная смерть (PvE)

**Цель:** Проверить механику смерти от монстров

**Шаги:**
1. Войдите хардкор-персонажем
2. Дайте убить себя монстру
3. Дождитесь автоматического выпуска духа

**Ожидаемый результат:**
- ✅ Автоматический выпуск духа
- ✅ Невозможность воскреснуть через Целителя Душ
- ✅ Глобальное сообщение о смерти (если уровень 20+)
- ✅ Статус "ПОГИБ НАВСЕГДА" в `.hardcore status`

---

### Тест 4: Окончательная смерть (PvP)

**Цель:** Проверить механику смерти от игрока

**Шаги:**
1. Создайте двух хардкор-персонажей
2. Вызовите одного на дуэль
3. Дайте убить себя

**Ожидаемый результат:**
- ✅ То же самое, что в Тесте 3
- ✅ В сообщении указан убийца

---

### Тест 5: Блокировка групп

**Цель:** Проверить ограничения группировки

**Шаги:**
1. Хардкор-персонаж приглашает обычного персонажа
2. Обычный персонаж приглашает хардкор-персонажа
3. Хардкор-персонаж 10 уровня приглашает хардкор-персонажа 20 уровня

**Ожидаемый результат:**
- ✅ Шаг 1: Отказано (разные режимы)
- ✅ Шаг 2: Отказано (разные режимы)
- ✅ Шаг 3: Отказано (разница > 5 уровней)

---

### Тест 6: Блокировка обмена

**Цель:** Проверить ограничения трейда

**Шаги:**
1. Хардкор-персонаж пытается обменяться с обычным
2. Обычный пытается обменяться с хардкором
3. Два хардкор-персонажа обмениваются

**Ожидаемый результат:**
- ✅ Шаги 1-2: Отказано
- ✅ Шаг 3: Разрешено

---

### Тест 7: Блокировка аукциона

**Цель:** Проверить блокировку аукциона

**Шаги:**
1. Хардкор-персонаж взаимодействует с аукционистом

**Ожидаемый результат:**
- ✅ Сообщение: "Аукцион недоступен..."
- ✅ Окно аукциона не открывается

---

### Тест 8: Блокировка почты

**Цель:** Проверить блокировку почты

**Шаги:**
1. Хардкор-персонаж пытается отправить письмо
2. Хардкор-персонажу отправляют письмо

**Ожидаемый результат:**
- ✅ Отправка заблокирована
- ✅ Получение заблокировано

---

### Тест 9: Блокировка полей боя

**Цель:** Проверить блокировку БГ

**Шаги:**
1. Хардкор-персонаж пытается зарегистрироваться на БГ

**Ожидаемый результат:**
- ✅ Сообщение: "Поля боя недоступны..."
- ✅ Регистрация отменена

---

### Тест 10: Блокировка арены

**Цель:** Проверить блокировку арены

**Шаги:**
1. Хардкор-персонаж пытается зарегистрироваться на арену

**Ожидаемый результат:**
- ✅ Сообщение: "Арена недоступна..."
- ✅ Регистрация отменена

---

### Тест 11: Кулдаун подземелий

**Цель:** Проверить систему кулдаунов

**Шаги:**
1. Войдите в подземелье хардкор-персонажем
2. Используйте `.hardcore status` для проверки кулдауна
3. Попытайтесь войти снова до истечения кулдауна
4. Дождитесь истечения кулдауна и войдите снова

**Ожидаемый результат:**
- ✅ При первом входе: сообщение о кулдауне 24 часа
- ✅ `.hardcore status` показывает оставшееся время
- ✅ При попытке повторного входа: телепорт назад
- ✅ После истечения: вход разрешен

**Примечание:** Для тестирования измените `Hardcore.DungeonCooldown = 0.01` (36 секунд)

---

### Тест 12: Модификаторы урона

**Цель:** Проверить изменение урона

**Шаги:**
1. Обычный персонаж наносит 100 урона мобу
2. Хардкор-персонаж наносит урон тому же мобу
3. Моб наносит урон обычному персонажу
4. Моб наносит урон хардкор-персонажу

**Ожидаемый результат:**
- ✅ Хардкор наносит ~90 урона (-10%)
- ✅ Хардкор получает ~150 урона (+50%)

---

### Тест 13: Награды за уровни

**Цель:** Проверить систему наград

**Настройка конфига:**
```ini
Hardcore.TitleRewards = "10 1"
Hardcore.TalentRewards = "10 1"
Hardcore.ItemRewards = "10 2586"
```

**Шаги:**
1. Поднимите хардкор-персонажа до 10 уровня

**Ожидаемый результат:**
- ✅ Получен титул
- ✅ Получено очко таланта
- ✅ Предмет отправлен по почте

---

### Тест 14: Отключение на уровне

**Цель:** Проверить автоотключение режима

**Настройка конфига:**
```ini
Hardcore.DisableLevel = 10
```

**Шаги:**
1. Поднимите хардкор-персонажа до 10 уровня

**Ожидаемый результат:**
- ✅ Красная аура исчезла
- ✅ Глобальное сообщение о завершении
- ✅ `.hardcore status` показывает "Режим: ЗАВЕРШЕН"
- ✅ Все ограничения сняты

---

### Тест 15: MaxDeathLevel

**Цель:** Проверить отключение окончательной смерти

**Настройка конфига:**
```ini
Hardcore.MaxDeathLevel = 10
Hardcore.DisableLevel = 0
```

**Шаги:**
1. Поднимите хардкор-персонажа до 11 уровня
2. Умрите

**Ожидаемый результат:**
- ✅ Можно воскреснуть
- ✅ Красная аура осталась
- ✅ Бонусы продолжают работать
- ✅ Сообщение о снятии окончательной смерти

---

## Проверка логов

После каждого теста проверяйте логи сервера на наличие ошибок:

**Windows:**
```powershell
Get-Content G:\azerothcore-server\logs\Server.log -Tail 50
```

**Linux:**
```bash
tail -f /path/to/server/logs/Server.log
```

**Что искать:**
- ✅ `>> Loading mod-hardcore...` - модуль загружен
- ✅ Отсутствие ошибок компиляции скриптов
- ❌ Любые ошибки с упоминанием "hardcore"

---

## Чеклист функций

После тестирования отметьте работающие функции:

### Базовые механики
- [ ] Активация через GameObject
- [ ] Красная аура
- [ ] Автоматический выпуск духа
- [ ] Блокировка воскрешения
- [ ] Глобальные оповещения

### Ограничения
- [ ] Блокировка ДК
- [ ] Блокировка аукциона
- [ ] Блокировка почты (отправка + получение)
- [ ] Блокировка гильдейского банка
- [ ] Блокировка БГ
- [ ] Блокировка арены
- [ ] Принудительный PvE
- [ ] Ограничения групп (режим + уровень)
- [ ] Ограничения обмена
- [ ] Ограничения дуэлей
- [ ] Ограничения баффов

### Модификаторы
- [ ] Урон -10%
- [ ] Получаемый урон +50%
- [ ] Множитель опыта

### Продвинутые функции
- [ ] Кулдаун подземелий
- [ ] Команда .hardcore status
- [ ] Команда .hardcore info
- [ ] Награды титулами
- [ ] Награды талантами
- [ ] Награды предметами
- [ ] Награды достижениями
- [ ] DisableLevel
- [ ] MaxDeathLevel

---

## Известные проблемы

Если тест не проходит, проверьте:

1. **Объекты не видны** → Импортируйте SQL заново
2. **Команды не работают** → Пересоберите сервер с новым .cpp файлом
3. **Кулдаун не работает** → Хук `OnMapChanged` может отсутствовать в вашей версии AC
4. **БГ/Арена не блокируются** → Хуки могут отсутствовать, нужно обновить AC
5. **Модификаторы урона не работают** → Хуки могут отсутствовать в старой версии AC

---

## Отчет об ошибках

При обнаружении ошибки соберите следующую информацию:

1. **Версия AzerothCore** (commit hash)
2. **Версия модуля** (из CHANGELOG.md)
3. **Шаги воспроизведения**
4. **Ожидаемый результат**
5. **Фактический результат**
6. **Логи сервера** (последние 50 строк)
7. **Конфигурация модуля** (hardcore.conf)

Создайте issue на GitHub с этой информацией.
